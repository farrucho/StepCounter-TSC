#include "NeuralNetwork.h"
#include <math.h>
// Layer 0
static const float W0[11][32] = {
    { 2.66461909e-01f, 2.45965287e-01f, 8.03902373e-02f, -3.03159744e-01f, -9.51816887e-02f, -1.19146809e-01f, -2.17239425e-01f, -9.91189629e-02f, 2.14380592e-01f, -5.37370324e-01f, -2.16230646e-01f, 1.98219433e-01f, -4.12259668e-01f, 3.44855726e-01f, -1.25493333e-01f, -4.13908325e-02f, -3.68868172e-01f, -1.61357120e-01f, 1.09953329e-01f, 8.54017511e-02f, 3.69310707e-01f, -2.74350941e-01f, 3.71188730e-01f, -3.54483396e-01f, 1.04026899e-01f, -2.08915085e-01f, 3.88397604e-01f, 2.42628232e-01f, -2.47278154e-01f, 1.23839313e-02f, -4.65010777e-02f, 2.45656744e-01f },
    { -2.68229932e-01f, 3.20200145e-01f, 1.96935758e-02f, -4.67040539e-01f, -4.46159512e-01f, -3.91227186e-01f, 2.36333907e-01f, 1.67012051e-01f, 1.44195870e-01f, -5.12803018e-01f, -4.42672074e-02f, -2.84937471e-01f, -4.46206808e-01f, 1.94524452e-02f, -1.12502770e-02f, 3.66634965e-01f, -1.63728744e-01f, 9.03580412e-02f, 2.12810129e-01f, -2.83173680e-01f, -7.89876655e-02f, -1.28782511e-01f, -2.13598520e-01f, 3.53179693e-01f, 1.36791974e-01f, -3.51126611e-01f, -3.55446428e-01f, 2.77629852e-01f, 1.49922352e-02f, 1.45943798e-02f, 2.00300687e-03f, -2.57053882e-01f },
    { 3.85190576e-01f, 1.38438210e-01f, 2.09196180e-01f, 1.29615143e-01f, -1.66162059e-01f, -6.89077154e-02f, -1.90405771e-01f, 2.41810828e-02f, 2.16346934e-01f, -4.54131514e-01f, -7.22703859e-02f, 9.79139358e-02f, 8.12144056e-02f, -8.80485103e-02f, -2.84296244e-01f, -1.03192829e-01f, -6.28300235e-02f, 1.68974802e-01f, 4.69689846e-01f, 1.72947332e-01f, 1.20353743e-01f, -2.03617334e-01f, -1.04530588e-01f, 7.56552964e-02f, -4.07452397e-02f, 9.59310159e-02f, 3.81265819e-01f, 3.47757071e-01f, 1.49040788e-01f, 4.35774952e-01f, -3.46188754e-01f, 1.61480650e-01f },
    { 6.70569614e-02f, 1.76369399e-01f, -1.19944833e-01f, -2.04626575e-01f, 5.67188039e-02f, -1.76088050e-01f, -2.33142897e-01f, 1.64565086e-01f, 3.15478176e-01f, 2.56956041e-01f, -6.14239611e-02f, -1.23588584e-01f, -2.39219800e-01f, 3.94267917e-01f, -8.96557942e-02f, -3.28148067e-01f, -1.86959669e-01f, 2.08830774e-01f, 2.06113920e-01f, 3.25087219e-01f, 4.05934066e-01f, -4.72240567e-01f, 1.61103129e-01f, -5.62651157e-01f, 4.69077557e-01f, 3.90221417e-01f, -1.08950436e-02f, 2.06821352e-01f, 3.24346274e-01f, -2.42665634e-01f, -3.90349805e-01f, -3.28626424e-01f },
    { 4.32824753e-02f, -3.51349980e-01f, -1.94572717e-01f, -1.79014206e-01f, 8.65110233e-02f, -2.14759573e-01f, 8.64666030e-02f, -1.27005026e-01f, 2.14156240e-01f, -8.00770614e-03f, -4.36265916e-01f, 3.50106865e-01f, 2.70211548e-01f, 4.43978250e-01f, -1.71452433e-01f, -3.78085226e-01f, 1.75744683e-01f, 5.93448021e-02f, 5.65655828e-01f, 1.23199217e-01f, -6.61209226e-02f, -4.04608220e-01f, 2.91014403e-01f, -3.89763266e-01f, -6.91400468e-02f, -1.00417264e-01f, 3.36954385e-01f, 3.21064413e-01f, 1.53447822e-01f, 4.18801248e-01f, -1.73776001e-01f, -6.29246891e-01f },
    { 5.81167638e-02f, -3.84898409e-02f, 7.03745242e-03f, 5.16882762e-02f, -2.00258940e-01f, -2.54840814e-02f, -1.92766488e-01f, 2.06933573e-01f, 3.16039085e-01f, 2.08726078e-01f, -5.07057369e-01f, -5.06927550e-01f, 4.20642272e-02f, 1.86450988e-01f, -5.57824314e-01f, -4.65481162e-01f, -4.91418391e-01f, 3.14522088e-01f, -2.17676759e-01f, 1.66856975e-03f, 1.55563191e-01f, 2.13630974e-01f, -4.36329395e-01f, -6.98774517e-01f, 5.81044912e-01f, 3.05283129e-01f, 3.46748739e-01f, 3.45195413e-01f, -1.65667668e-01f, -2.09932908e-01f, -6.09266758e-01f, -5.56438327e-01f },
    { 2.73318619e-01f, -6.08471744e-02f, 2.52263546e-01f, -1.84184462e-01f, -1.77030370e-01f, 4.53791857e-01f, 3.13834518e-01f, -4.45494130e-02f, -4.75803204e-02f, -6.55910969e-02f, -3.82625490e-01f, 1.21066980e-01f, 2.19455764e-01f, 2.62338072e-01f, -2.18085364e-01f, -3.69894952e-01f, -1.20779879e-01f, -2.82327056e-01f, 1.81585371e-01f, 4.58374582e-02f, 1.04819797e-02f, -1.33124620e-01f, 1.49201125e-01f, -2.05618352e-01f, 2.83433557e-01f, 5.77605739e-02f, 1.41424611e-01f, -5.13419099e-02f, -4.06705476e-02f, 3.70368361e-01f, -2.97667831e-01f, -1.99954286e-01f },
    { 4.40775901e-01f, 3.51374336e-02f, 8.47173408e-02f, -8.43961164e-02f, 4.24864143e-01f, 1.73181493e-03f, 4.09051359e-01f, 3.56996983e-01f, -2.45022982e-01f, 2.13931143e-01f, -2.16553152e-01f, -2.73006745e-02f, 3.78667712e-01f, 4.32581037e-01f, -4.38209891e-01f, 1.43927336e-01f, 7.30784610e-02f, 6.99600428e-02f, 3.38359401e-02f, 4.18967813e-01f, -8.49774014e-03f, 1.09492019e-01f, -1.72538772e-01f, 8.01640972e-02f, 2.71558553e-01f, -1.38103113e-01f, 1.36915952e-01f, 2.19757020e-01f, 1.10341616e-01f, 2.08569661e-01f, 2.91021287e-01f, 3.57965305e-02f },
    { -1.32250041e-01f, 2.19670802e-01f, -3.21294695e-01f, -1.97626129e-01f, -1.87403888e-01f, -4.11443233e-01f, -4.33521330e-01f, 3.92223954e-01f, -1.41452268e-01f, -3.79922092e-01f, -1.39480904e-02f, -5.57415858e-02f, -2.73653660e-02f, 2.19928905e-01f, -3.13063651e-01f, -2.71827817e-01f, 3.48695517e-02f, 5.10030845e-03f, -3.63193512e-01f, 2.65281856e-01f, 3.73676151e-01f, 4.02970463e-01f, 8.32800288e-03f, 1.09399028e-01f, 1.85527563e-01f, 1.73541769e-01f, 1.60831854e-01f, 1.39609233e-01f, 2.25342050e-01f, -2.03030184e-01f, 9.36763659e-02f, -2.63472408e-01f },
    { 7.55863786e-02f, 7.67694861e-02f, 3.23394001e-01f, -3.05010602e-02f, -5.17329425e-02f, 9.37530398e-02f, -1.95581257e-01f, 3.05614173e-01f, -1.69336960e-01f, 2.47791633e-01f, 9.58435535e-02f, 2.96937615e-01f, -1.81404695e-01f, 4.89604771e-02f, -2.30516061e-01f, 2.79137224e-01f, -1.29343450e-01f, -1.50644451e-01f, -1.03907928e-01f, -1.34727299e-01f, 2.43302509e-01f, -4.79308993e-01f, 1.44092605e-01f, -1.33144960e-01f, -3.73372108e-01f, 3.14206719e-01f, 3.59780312e-01f, 4.86832321e-01f, -1.93554550e-01f, 2.17828467e-01f, 1.07024379e-01f, 7.52809644e-02f },
    { -4.50990528e-01f, 6.01040304e-01f, -1.39089540e-01f, -4.30601567e-01f, 3.40923756e-01f, -3.35112602e-01f, 4.00658488e-01f, 6.60319850e-02f, 1.27063721e-01f, -2.01159075e-01f, -9.09722410e-03f, 2.82205045e-01f, -4.17238802e-01f, -2.89424181e-01f, -8.40347260e-03f, 2.82930881e-01f, 5.29418662e-02f, 1.42309219e-01f, 3.10617417e-01f, -4.10661221e-01f, 1.12407997e-01f, -3.06515962e-01f, 5.55880740e-03f, 1.67132601e-01f, -5.00738993e-03f, 9.24492627e-02f, -2.42890030e-01f, 3.07387151e-02f, 2.67106175e-01f, 3.99559319e-01f, -1.79692060e-01f, 9.99609604e-02f },
};

static const float b0[32] = {
-1.12733640e-01f, -1.34319559e-01f, 1.43790217e-02f, -4.57881344e-03f, 2.35086575e-01f, 7.35484511e-02f, 2.54888654e-01f, 3.71401191e-01f, -1.88510224e-01f, -5.67648560e-02f, 3.88142504e-02f, 2.99094677e-01f, 8.57147761e-03f, -1.09807894e-01f, 4.29730378e-02f, 1.52608380e-01f, 9.80333164e-02f, 2.21467316e-01f, 2.52884716e-01f, -1.24102496e-01f, 3.04286093e-01f, 1.35510013e-01f, 1.57328859e-01f, -6.16404600e-02f, -2.18175743e-02f, -8.78905952e-02f, -1.87446520e-01f, -2.27337316e-01f, 1.36420608e-01f, 2.40322322e-01f, 8.57314840e-02f, -3.47418035e-03f};

// Layer 1
static const float W1[32][16] = {
    { -2.69838087e-02f, -1.75477386e-01f, 1.16017200e-02f, 1.61101550e-01f, 1.59497902e-01f, 2.22930044e-01f, -4.03220862e-01f, -2.04436764e-01f, 4.12826419e-01f, 2.28911564e-02f, 1.83771431e-01f, 1.21530509e-02f, 3.64061475e-01f, -2.91623026e-01f, -3.43558341e-01f, 4.54820603e-01f },
    { -4.16195840e-01f, -1.35546461e-01f, 6.81563979e-03f, -3.24498653e-01f, 3.72485459e-01f, -2.94623852e-01f, 7.91387334e-02f, -4.81464639e-02f, 2.54936486e-01f, -4.31640357e-01f, -2.89514631e-01f, -2.40678430e-01f, 5.59157193e-01f, 9.58958864e-02f, 1.16538055e-01f, 4.59560812e-01f },
    { -8.86227936e-02f, 2.77190596e-01f, 4.06896502e-01f, 3.00818145e-01f, -4.06329036e-02f, -2.09323093e-01f, -7.80307204e-02f, -2.11544693e-01f, -1.04379386e-01f, -3.68265435e-02f, 6.37289211e-02f, 8.03716108e-02f, 2.48521551e-01f, 1.59699291e-01f, 3.27726275e-01f, -2.48070836e-01f },
    { -1.67438630e-02f, 3.39166522e-01f, 2.86983639e-01f, 1.71769619e-01f, 3.55034083e-01f, -1.71268061e-01f, -4.99942005e-02f, 1.66183248e-01f, -9.49607715e-02f, -3.79226208e-02f, -1.53799027e-01f, 7.25115389e-02f, 4.65482652e-01f, -6.29828945e-02f, 1.20055810e-01f, 8.45205411e-02f },
    { 4.31317031e-01f, -9.19211879e-02f, 1.05660327e-01f, -3.06067318e-01f, 3.66695255e-01f, 3.10641170e-01f, 2.22386375e-01f, 4.01604921e-01f, -8.14487264e-02f, 3.04605305e-01f, -2.56155342e-01f, -3.48223090e-01f, 1.01985939e-01f, 3.56669396e-01f, -4.03960096e-03f, 2.20506847e-01f },
    { -2.50250459e-01f, -2.17667460e-01f, 3.92108172e-01f, -1.21761359e-01f, -1.35154188e-01f, -2.62952834e-01f, -4.83216375e-01f, -1.06367111e-01f, -4.19687591e-02f, -4.99363333e-01f, 4.45263624e-01f, 2.54855722e-01f, 4.85741615e-01f, -4.41963583e-01f, 1.73598349e-01f, -1.67573877e-02f },
    { 4.10499364e-01f, 6.30986923e-03f, 3.70427072e-01f, -1.46029428e-01f, -4.21244912e-02f, 4.94620889e-01f, 3.22464228e-01f, 2.40360469e-01f, -3.88555080e-01f, 5.55743754e-01f, -2.03079060e-01f, 1.33183107e-01f, 1.91968903e-01f, 1.13035373e-01f, 9.70480293e-02f, 8.67822021e-02f },
    { -1.55695453e-01f, -2.90962338e-01f, 1.65903941e-01f, -2.58111268e-01f, 3.24484050e-01f, 3.08210820e-01f, 3.63871843e-01f, 3.16189408e-01f, 3.03651482e-01f, 3.43358070e-01f, 3.57464552e-02f, -1.62710652e-01f, 2.83546805e-01f, 2.50212371e-01f, -3.64713281e-01f, -2.02274080e-02f },
    { -4.38571841e-01f, 1.07158318e-01f, 1.10890806e-01f, 1.84129700e-01f, 3.02878469e-01f, -2.73853034e-01f, -1.84095398e-01f, -1.35577083e-01f, 4.49416578e-01f, -2.88125783e-01f, 6.61025420e-02f, 2.10130557e-01f, 3.94202203e-01f, -1.23173013e-01f, 2.11261153e-01f, -6.97505251e-02f },
    { -3.64627510e-01f, 4.57576662e-01f, 1.02738254e-02f, -1.15648918e-01f, 3.68005425e-01f, -1.83348674e-02f, -5.50760143e-02f, -3.06019247e-01f, 2.79668242e-01f, -4.82281089e-01f, 1.89805254e-01f, 5.87802604e-02f, 1.22533053e-01f, -4.37847465e-01f, 2.08315447e-01f, -1.42659977e-01f },
    { -3.40751171e-01f, 4.95384037e-01f, 4.80586767e-01f, -2.02852741e-01f, -1.42818600e-01f, -2.28269756e-01f, 2.79949382e-02f, -5.89880645e-01f, -2.02147499e-01f, -4.01591390e-01f, 3.51120174e-01f, -1.65850610e-01f, 3.83506387e-01f, -3.14063311e-01f, -3.51534188e-01f, 3.73264402e-01f },
    { -9.76694450e-02f, 1.35630608e-01f, 2.67275333e-01f, 6.91916347e-02f, -2.16449037e-01f, 4.63765711e-01f, 2.22336337e-01f, 3.57380778e-01f, -2.51059085e-01f, 4.98057812e-01f, 1.37442619e-01f, 3.15458179e-02f, 2.30529860e-01f, 5.03953099e-01f, -2.49418870e-01f, 2.00583071e-01f },
    { -3.63797396e-01f, -2.13042814e-02f, 1.35080665e-01f, 4.57904525e-02f, 5.72064221e-01f, -4.78578985e-01f, -2.98461556e-01f, -4.01866317e-01f, -1.61889121e-01f, -4.77560580e-01f, 4.72517550e-01f, 1.74603865e-01f, 6.88404381e-01f, 1.20035738e-01f, -6.96761236e-02f, 1.06459878e-01f },
    { 1.59224376e-01f, 1.54621989e-01f, 4.02490824e-01f, -9.11031514e-02f, -1.08192310e-01f, -1.67044194e-03f, -2.40262866e-01f, 2.78751142e-02f, 5.11595421e-02f, -4.14988190e-01f, -8.80412161e-02f, -7.42690861e-02f, 4.18522686e-01f, -9.44111645e-02f, -9.26652178e-02f, 3.23914945e-01f },
    { -1.78417519e-01f, 4.88301426e-01f, 4.01051641e-01f, 1.43816158e-01f, -3.04357737e-01f, -2.89271504e-01f, -4.05419879e-02f, -2.74078339e-01f, -2.52934307e-01f, -1.29498154e-01f, 2.93773621e-01f, -2.17964172e-01f, 4.22728419e-01f, -4.04948667e-02f, -1.45803392e-01f, 5.43387979e-02f },
    { -1.92583427e-02f, 5.92088141e-03f, 3.44081134e-01f, -1.51584968e-01f, -3.13838184e-01f, -2.70089526e-02f, -4.08893265e-02f, 2.36637011e-01f, 8.25431850e-03f, 1.93092301e-01f, 3.99189025e-01f, 2.35672995e-01f, 3.93678062e-02f, 3.13613191e-02f, 2.24452645e-01f, 3.09286833e-01f },
    { 1.65350184e-01f, 2.45666236e-01f, 1.93210393e-01f, -2.43692830e-01f, -1.57478258e-01f, 6.18760921e-02f, -4.38572392e-02f, -1.25700505e-02f, -7.76517212e-01f, -2.39526927e-01f, 4.63199288e-01f, -1.34683818e-01f, 5.44698596e-01f, 1.63454294e-01f, 7.19594359e-02f, 1.92788243e-01f },
    { -8.37515593e-02f, -2.17779800e-01f, -4.43067491e-01f, 2.08971858e-01f, 3.74149941e-02f, 1.03867158e-01f, 4.78297472e-01f, 4.38804895e-01f, 4.42561597e-01f, 5.16253769e-01f, -2.61505172e-02f, -3.75766784e-01f, -3.65692347e-01f, 3.26743834e-02f, 1.31670862e-01f, -3.09185028e-01f },
    { 4.25249696e-01f, 2.03648508e-01f, -4.84011918e-01f, -5.04979081e-02f, -4.22206700e-01f, 7.61132687e-02f, 3.56332734e-02f, 3.90559405e-01f, 1.44777074e-01f, 5.93068339e-02f, -3.39769393e-01f, -3.41022789e-01f, 1.86970577e-01f, -9.98125225e-02f, 1.24140769e-01f, -5.13589680e-02f },
    { 1.41027411e-02f, 4.35759634e-01f, 8.37067980e-03f, 2.10135221e-01f, -4.66393232e-02f, -1.82579309e-01f, -3.99029106e-01f, -2.99870759e-01f, -7.74253458e-02f, 7.46092945e-02f, 4.19911981e-01f, -8.43060017e-02f, 5.37322819e-01f, 2.29722574e-01f, 7.65187219e-02f, 2.50408441e-01f },
    { 3.64698060e-02f, -1.74423009e-01f, -2.60674059e-01f, -8.40682443e-03f, 3.30273062e-01f, 1.81733295e-01f, 4.51814085e-01f, 6.57871813e-02f, 4.84128803e-01f, 2.17749149e-01f, 1.33573338e-01f, 1.05948895e-01f, -1.92144275e-01f, 1.56665385e-01f, -2.19255045e-01f, 1.93981770e-02f },
    { 1.42867163e-01f, 1.14425369e-01f, 2.21088111e-01f, -1.47001341e-01f, -2.73121983e-01f, 3.84577245e-01f, 3.16554993e-01f, -3.67228203e-02f, -2.03621045e-01f, 2.92044371e-01f, -2.72409141e-01f, 4.51874025e-02f, -1.26553208e-01f, -5.17340004e-01f, 1.39551669e-01f, 3.18151951e-01f },
    { 3.24996263e-01f, -1.86504066e-01f, -5.32993264e-02f, -1.76336646e-01f, -3.06028515e-01f, 1.72174826e-01f, -1.17906176e-01f, 3.14098209e-01f, -6.64839298e-02f, 1.58484851e-03f, 2.20506415e-01f, 1.06695138e-01f, -3.95716131e-01f, 1.10348938e-02f, -1.78600624e-01f, -1.99783638e-01f },
    { -1.29798695e-01f, 5.20511687e-01f, 1.34545295e-02f, -9.40734074e-02f, 1.90342478e-02f, -4.49471444e-01f, -5.11464715e-01f, -4.63322401e-01f, -1.38566373e-02f, -3.83249581e-01f, 1.70200631e-01f, 5.54700289e-03f, 4.02225882e-01f, -7.93996155e-02f, 6.64943084e-02f, 1.43700495e-01f },
    { 2.87927836e-01f, -2.39667103e-01f, 1.47472769e-02f, -9.91770253e-02f, 2.81977594e-01f, -1.05263561e-01f, -9.26719308e-02f, -5.39112210e-01f, -3.35480198e-02f, -2.19189435e-01f, 2.36873984e-01f, 2.81613708e-01f, 2.43409142e-01f, -5.22907615e-01f, 1.27546936e-01f, 2.69420117e-01f },
    { -2.98689008e-01f, 2.89520800e-01f, 3.83841485e-01f, 2.25453705e-01f, 8.07077065e-02f, -4.58599955e-01f, 1.47332087e-01f, -5.45811988e-02f, 3.17803532e-01f, -2.73677796e-01f, 2.46622950e-01f, -3.27226549e-01f, 5.63438475e-01f, 4.64888029e-02f, -1.66588321e-01f, -4.00470160e-02f },
    { -4.21961278e-01f, 4.74863470e-01f, 2.20189616e-01f, -3.16716582e-01f, 3.89136188e-02f, 2.43305154e-02f, -3.32090825e-01f, -2.48126879e-01f, 2.09879428e-02f, -1.09012194e-01f, 3.25203598e-01f, 2.71661639e-01f, 5.43698013e-01f, -1.78297326e-01f, -2.29450837e-01f, 6.81176335e-02f },
    { -4.64342594e-01f, -5.38236015e-02f, -2.01948524e-01f, 1.06601357e-01f, 1.83273196e-01f, -3.24142039e-01f, 7.69774988e-02f, -3.86835337e-01f, 2.62610734e-01f, 2.97073554e-02f, 8.23450238e-02f, -2.97728062e-01f, 4.33024913e-01f, 1.80176184e-01f, -1.03213713e-01f, 2.27611542e-01f },
    { 3.86956185e-01f, 3.25012580e-02f, 2.48615220e-01f, -3.29713672e-01f, 3.51034015e-01f, 1.43357918e-01f, 2.47685209e-01f, -1.67977542e-01f, 7.28912801e-02f, -1.70688435e-01f, 2.28772581e-01f, -1.64775290e-02f, -3.02608967e-01f, 3.67263630e-02f, -1.54896691e-01f, -1.91464990e-01f },
    { 4.98315483e-01f, -4.12665419e-02f, -3.84411395e-01f, -1.21445611e-01f, -2.29425743e-01f, 4.25557613e-01f, 3.12018007e-01f, 3.83522958e-01f, 2.41399221e-02f, 4.30452615e-01f, 1.86653182e-01f, -2.07578734e-01f, -3.58462065e-01f, 6.49287775e-02f, -2.63397664e-01f, -2.86532402e-01f },
    { -5.43600857e-01f, -6.55592829e-02f, 1.92027822e-01f, -6.85332268e-02f, 6.06562123e-02f, -3.69538039e-01f, -3.03898454e-01f, -7.84376860e-02f, 2.11370885e-01f, -5.92469156e-01f, 2.69001186e-01f, -2.10287765e-01f, 1.92859724e-01f, -3.76711071e-01f, -1.55953035e-01f, 5.18537104e-01f },
    { 5.78980148e-02f, 2.50423789e-01f, 3.40186320e-02f, 8.00675061e-03f, 3.45146880e-02f, -4.55416024e-01f, -6.01191521e-01f, -4.66489524e-01f, -1.07280023e-01f, -5.38302183e-01f, 1.85459182e-01f, 2.61906922e-01f, 2.23537400e-01f, -8.02902579e-02f, 1.78152785e-01f, -4.10298705e-02f },
};

static const float b1[16] = {
2.63315737e-01f, 4.15694015e-03f, 3.21976021e-02f, -2.55130325e-02f, 3.47382836e-02f, 2.12202862e-01f, 1.68533117e-01f, 2.31434077e-01f, -1.30477190e-01f, 3.63784462e-01f, -1.22107618e-01f, -4.35940139e-02f, -5.12617640e-02f, 1.67026758e-01f, -9.02520586e-03f, -1.65407248e-02f};

// Layer 2
static const float W2[16][1] = {
    { 3.99786443e-01f },
    { -5.82886875e-01f },
    { -3.87049407e-01f },
    { 4.12768334e-01f },
    { -1.03624165e+00f },
    { 8.56211364e-01f },
    { 4.23138589e-01f },
    { 5.58006942e-01f },
    { -6.57379687e-01f },
    { 3.97556961e-01f },
    { -4.75489408e-01f },
    { 3.88066113e-01f },
    { -2.22385854e-01f },
    { 5.71524382e-01f },
    { 3.62190694e-01f },
    { -7.01658130e-01f },
};

static const float b2[1] = {
1.17880546e-01f};

NeuralNetwork neuralNet;

NeuralNetwork::NeuralNetwork() {}

float NeuralNetwork::relu(float x) const {
    return (x > 0.0f) ? x : 0.0f;
}

float NeuralNetwork::sigmoid(float x) const {
    return 1.0f / (1.0f + expf(-x));
}

void NeuralNetwork::dense(const float *input, int in_size,
                          const float *W, const float *b,
                          int out_size, float *output) const
{
    for (int o = 0; o < out_size; o++) {
        float sum = b[o];
        for (int i = 0; i < in_size; i++) {
            sum += input[i] * W[i * out_size + o];
        }
        output[o] = sum;
    }
}

float NeuralNetwork::predict(const float input[11])
{
    float h1[32];
    float h2[16];
    float out[1];

    dense(input, 11, (float*)W0, b0, 32, h1);
    for (int i = 0; i < 32; i++) h1[i] = relu(h1[i]);

    dense(h1, 32, (float*)W1, b1, 16, h2);
    for (int i = 0; i < 16; i++) h2[i] = relu(h2[i]);

    dense(h2, 16, (float*)W2, b2, 1, out);
    return sigmoid(out[0]);
}

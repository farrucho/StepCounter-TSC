#include "NeuralNetwork.h"
#include <math.h>
const float SCALER_MEANS[11] = { 0.030834f, -0.035068f, 0.030834f, 0.065902f, 0.065902f, 0.024979f, 0.003468f, 0.003683f, 0.495707f, 0.504293f, 29.615732f };
const float SCALER_STDS[11] = { 0.084076f, 0.054017f, 0.084076f, 0.110090f, 0.109714f, 0.039779f, 0.005618f, 0.006465f, 0.180797f, 0.180797f, 14.270586f };


// Layer 0
static const float W0[11][32] = {
    { 2.58020580e-01f, 1.01070210e-01f, -1.62802767e-02f, 2.27798268e-01f, -1.70451459e-02f, 3.22207004e-01f, 4.97420549e-01f, 3.67374480e-01f, -4.83174562e-01f, 4.12366748e-01f, -1.17933087e-01f, -1.82267651e-01f, 2.05576316e-01f, 3.79873276e-01f, -5.28810263e-01f, -2.85071045e-01f, -2.95781679e-02f, 1.13059953e-01f, -4.14991349e-01f, -5.46511173e-01f, 6.10237420e-02f, 2.35838562e-01f, 2.35486701e-01f, -1.70842737e-01f, 5.39724052e-01f, -6.94288015e-02f, -1.08005382e-01f, 2.28486881e-01f, -2.49299631e-01f, -2.77676702e-01f, 3.71769726e-01f, 3.97714287e-01f },
    { -1.08167723e-01f, 2.51726031e-01f, -1.06209859e-01f, -1.44201651e-01f, 5.18663406e-01f, 6.95995195e-03f, 8.78236443e-03f, -3.51105601e-01f, -2.58626074e-01f, 6.83511138e-01f, -2.37114444e-01f, -8.50319490e-03f, 6.24895632e-01f, 8.25154707e-02f, 3.69843334e-01f, 1.56244099e-01f, -1.59653097e-01f, 3.15024316e-01f, 1.77034453e-01f, -1.52753413e-01f, 3.77453789e-02f, -3.97653162e-01f, -3.31798017e-01f, 4.04897273e-01f, 3.46424073e-01f, -4.35989827e-01f, -4.51458961e-01f, -1.58975333e-01f, 6.42870367e-02f, -3.97585362e-01f, -2.21153021e-01f, 3.55042256e-02f },
    { 4.12013888e-01f, 1.32821158e-01f, -4.07109186e-02f, -1.81805640e-01f, -2.84022331e-01f, 4.35247302e-01f, -1.28793523e-01f, 4.90644753e-01f, -2.94278972e-02f, 2.44989857e-01f, 1.33486256e-01f, 3.31702381e-01f, 3.14786077e-01f, 2.01147482e-01f, -3.51765543e-01f, 2.36224290e-02f, -2.80543983e-01f, -4.09692049e-01f, -3.16687971e-01f, -4.64018822e-01f, -2.85399288e-01f, -1.74249917e-01f, -7.25617856e-02f, 1.25430197e-01f, 2.99074590e-01f, 1.05252832e-01f, 1.69705182e-01f, -2.59088054e-02f, 2.68835962e-01f, -6.20896280e-01f, -4.27499600e-02f, -2.66083091e-01f },
    { 1.91827923e-01f, -1.62382111e-01f, -7.98817948e-02f, 1.86637461e-01f, -2.88410455e-01f, 3.35238129e-01f, 8.32331628e-02f, -2.69173115e-01f, -4.04418632e-03f, -1.07792810e-01f, -1.31573930e-01f, -1.32732943e-01f, -1.99529633e-01f, 1.21870391e-01f, -3.19665581e-01f, 2.97661930e-01f, -4.26222116e-01f, -3.56572777e-01f, -3.21700662e-01f, -3.12137883e-02f, 1.26499861e-01f, 3.33494484e-01f, -3.22635442e-01f, 1.93139225e-01f, -2.37130642e-01f, 2.92661786e-01f, 1.86761111e-01f, 2.17451289e-01f, 1.10578418e-01f, 7.85865709e-02f, 1.69745669e-01f, 3.53127599e-01f },
    { 3.21725905e-01f, 3.79575670e-01f, 3.51876110e-01f, 4.04457152e-01f, -4.10172313e-01f, 1.09543912e-01f, 3.24736834e-01f, 2.60413378e-01f, 2.94908226e-01f, -3.63297611e-02f, 3.34552914e-01f, 1.58586472e-01f, -2.86296874e-01f, 2.83479899e-01f, -2.42601052e-01f, -2.57756770e-01f, -8.21469724e-03f, 1.29290167e-02f, 1.85496777e-01f, -4.07799065e-01f, 1.29528731e-01f, 3.25823694e-01f, 1.80547148e-01f, 7.55455270e-02f, 2.81831086e-01f, 2.68189814e-02f, 1.05364986e-01f, 3.19576785e-02f, 9.27646160e-02f, -2.03704476e-01f, 3.37307632e-01f, 6.41540810e-03f },
    { 5.22382975e-01f, -1.63212895e-01f, 2.50633746e-01f, 1.82903543e-01f, -2.75376409e-01f, -2.70764083e-02f, 1.63346827e-01f, 1.82001650e-01f, 3.58475029e-01f, 4.01788771e-01f, 2.66459137e-01f, -1.95762485e-01f, 9.10863653e-03f, -4.06464309e-01f, -4.44602281e-01f, -3.49864103e-02f, -3.11192572e-01f, 2.38225594e-01f, -3.76624823e-01f, -3.21821690e-01f, -2.98301965e-01f, 4.66578603e-01f, 1.94987729e-02f, -2.68578678e-01f, -4.97070402e-02f, 1.34037763e-01f, 2.87592392e-02f, 1.70160934e-01f, -1.44688681e-01f, 8.10177848e-02f, 1.26422927e-01f, -1.12572826e-01f },
    { -1.35618731e-01f, -2.33561262e-01f, 2.41433963e-01f, 9.31537524e-02f, 7.98616633e-02f, -6.00149855e-02f, -4.60894614e-01f, 2.09209144e-01f, 7.02245459e-02f, 7.59753361e-02f, -1.86637640e-01f, 1.15742326e-01f, -4.60763648e-02f, 2.14798957e-01f, 7.05812722e-02f, 4.07669485e-01f, 2.09865719e-01f, -1.21102639e-01f, -1.25820488e-01f, 2.25341663e-01f, 4.45790470e-01f, 3.64722520e-01f, -4.15374376e-02f, 6.92964047e-02f, 8.04208145e-02f, -2.37282008e-01f, -3.45410973e-01f, -3.52318794e-01f, 1.00921035e-01f, -2.79779673e-01f, 2.38232896e-01f, 3.50058287e-01f },
    { -2.47040316e-01f, 3.58666629e-01f, -6.10130094e-02f, 3.29426080e-01f, 2.94670552e-01f, 3.87690008e-01f, -2.04291523e-01f, -1.14647157e-01f, -3.16053987e-01f, -1.52897224e-01f, 1.48486853e-01f, 2.30052456e-01f, -1.56327970e-02f, -3.68519463e-02f, 3.77486914e-01f, 2.30292723e-01f, 1.53918147e-01f, -1.38502568e-01f, -2.92107880e-01f, -1.08064078e-01f, -1.52366042e-01f, 2.75641382e-01f, 3.27273875e-01f, 4.44596916e-01f, 2.94211626e-01f, -4.95779105e-02f, 2.91927308e-01f, 1.65972039e-01f, 1.78930685e-01f, 2.97815166e-02f, -5.06051853e-02f, -2.12030664e-01f },
    { 1.63861409e-01f, -2.79346734e-01f, 1.93341643e-01f, -2.25338444e-01f, -9.06866938e-02f, -1.69944301e-01f, 1.09144934e-01f, 4.02381131e-03f, -5.01337707e-01f, 1.15001626e-01f, -1.90067902e-01f, 2.18695357e-01f, 2.80118585e-01f, 3.56656849e-01f, -1.59814477e-01f, 1.34176955e-01f, 2.96346188e-01f, 1.00366317e-01f, 2.11721301e-01f, -1.68325230e-01f, -3.42356473e-01f, -5.25024235e-01f, -4.82001007e-01f, -2.99292684e-01f, -1.79505512e-01f, 1.34043425e-01f, 2.13952214e-01f, -6.61973953e-02f, 2.75851578e-01f, -4.05885801e-02f, 5.08576930e-02f, -1.86976399e-02f },
    { 2.17640892e-01f, -1.34103373e-01f, -6.06485754e-02f, 2.69743979e-01f, -1.40007645e-01f, 9.45160016e-02f, 8.49153176e-02f, -2.79460065e-02f, 4.00368333e-01f, 1.09983496e-01f, -2.66851902e-01f, 2.77159274e-01f, 2.18057603e-01f, 3.39670300e-01f, -2.25414142e-01f, 2.91172028e-01f, 2.39842311e-01f, 1.78321779e-01f, -3.32777053e-01f, 1.05998978e-01f, 3.38756830e-01f, 9.70400572e-02f, 3.96332191e-03f, -2.20749289e-01f, -3.25375646e-01f, -2.25679219e-01f, -9.26932245e-02f, -1.71758726e-01f, 5.75561449e-02f, 1.05836904e-02f, 3.43015403e-01f, -1.21629417e-01f },
    { 1.81397915e-01f, 3.72121096e-01f, 1.79625466e-01f, 1.54126570e-01f, 2.94458449e-01f, -4.32971895e-01f, 3.88760269e-01f, -3.45572740e-01f, 9.95030329e-02f, -6.40147403e-02f, 8.67702737e-02f, -4.48349088e-01f, -1.69589639e-01f, 1.80694655e-01f, -8.66316780e-02f, -3.82893384e-01f, -2.28604794e-01f, 1.03083618e-01f, 1.79399118e-01f, 5.15265763e-01f, -3.23823810e-01f, -2.09217116e-01f, 2.39464402e-01f, 4.20488805e-01f, -4.21896398e-01f, -3.99181470e-02f, -1.14011355e-01f, 2.07859576e-01f, -1.25555210e-02f, 6.66997433e-02f, -8.21496546e-02f, 3.00530046e-01f },
};

static const float b0[32] = {
7.12535903e-02f, 3.83668065e-01f, 2.87268996e-01f, 1.98234901e-01f, 1.93918526e-01f, -3.53235364e-01f, -3.83162409e-01f, -4.22554195e-01f, 8.18818361e-02f, 2.38298506e-01f, 3.03217590e-01f, -6.66215830e-03f, 9.56099406e-02f, 1.11566111e-01f, 3.21876466e-01f, 1.57806218e-01f, 2.81376839e-01f, 1.75281465e-01f, 1.98257610e-01f, 1.46346405e-01f, 4.26010834e-03f, -3.91881824e-01f, -2.65825331e-01f, 4.02457625e-01f, 2.83233039e-02f, 6.82998225e-02f, -2.26818502e-01f, -3.17242622e-01f, 1.96000248e-01f, 9.60157290e-02f, -3.49424630e-01f, 2.27309465e-01f};

// Layer 1
static const float W1[32][16] = {
    { 1.45717651e-01f, 5.15412763e-02f, 8.09335113e-02f, -1.62206814e-01f, -1.55627400e-01f, -6.66583121e-01f, 1.38581529e-01f, 2.67284930e-01f, -1.59018561e-02f, -1.67423606e-01f, 7.03602582e-02f, -8.49826261e-02f, -6.56431615e-02f, -3.04385632e-01f, 8.38271901e-02f, 1.97857708e-01f },
    { 5.60797215e-01f, 3.48866165e-01f, 3.37404281e-01f, 1.11993931e-01f, 3.41422200e-01f, 1.71492130e-01f, -2.80072927e-01f, -1.67416945e-01f, 2.57164448e-01f, 2.11073026e-01f, 5.02060294e-01f, 2.30707869e-01f, 4.61184978e-01f, 1.40462354e-01f, -1.29485935e-01f, -5.96148595e-02f },
    { 4.40128446e-01f, 3.99317801e-01f, 1.61543995e-01f, 1.95787326e-01f, 8.15924630e-03f, -1.54374167e-01f, 2.55416453e-01f, 1.85009211e-01f, 8.80525708e-02f, 1.83853224e-01f, 1.69156224e-01f, -3.04687291e-01f, 2.32517794e-01f, 2.22107358e-02f, -5.86576276e-02f, -1.26372948e-01f },
    { 1.46565046e-02f, 5.91939203e-02f, 2.63921440e-01f, 1.23508185e-01f, -1.66980028e-01f, -1.39475435e-01f, 4.07858580e-01f, -1.77780628e-01f, 2.77438760e-01f, -9.59112495e-03f, -7.81375617e-02f, -1.10435318e-02f, 2.72718340e-01f, -1.68597959e-02f, 2.08621413e-01f, 2.82067746e-01f },
    { -4.63989943e-01f, -5.37588716e-01f, -3.94210406e-02f, 2.64462471e-01f, 2.94696391e-01f, 2.76054233e-01f, 1.67962000e-01f, 4.85528022e-01f, 1.54988915e-01f, -4.78186578e-01f, -1.52794849e-02f, 3.71351123e-01f, -2.16643959e-01f, -3.55515867e-01f, -2.53234446e-01f, 5.41147709e-01f },
    { -2.53771544e-01f, -2.79004097e-01f, 2.75375485e-01f, -2.20945090e-01f, 2.04103917e-01f, 3.44271868e-01f, 3.93007576e-01f, 3.68910193e-01f, 3.74649078e-01f, 1.69935990e-02f, 2.47323811e-02f, -2.48146951e-02f, -3.93724561e-01f, -1.46749303e-01f, -1.34968698e-01f, -1.80450097e-01f },
    { -4.00031477e-01f, -3.01621258e-01f, -2.42442369e-01f, 6.59009039e-01f, 2.36040279e-01f, -2.39372775e-01f, 5.87960541e-01f, 1.75051674e-01f, 2.37115934e-01f, -1.16583943e-01f, -5.25619805e-01f, -2.81730175e-01f, -6.28467083e-01f, -8.37556645e-02f, -2.44034216e-01f, 3.84446174e-01f },
    { -1.44961327e-01f, -4.55903590e-01f, -3.24316800e-01f, 5.06968535e-02f, -3.64632532e-02f, 1.35194078e-01f, 2.53700286e-01f, 5.67708537e-02f, 8.75726063e-03f, -2.19212890e-01f, -2.49070391e-01f, -2.87101597e-01f, 1.02816574e-01f, -2.05440626e-01f, -8.00090432e-02f, 2.77999580e-01f },
    { 1.51757076e-01f, 7.98289999e-02f, -3.99098665e-01f, 4.31027323e-01f, -1.49070784e-01f, 2.54553139e-01f, 2.51510680e-01f, 4.11279127e-03f, -1.89059645e-01f, -2.10568205e-01f, 2.88000051e-02f, -3.09073657e-01f, 2.11641073e-01f, -3.89064699e-01f, 4.52195480e-02f, 4.86896276e-01f },
    { 1.66805238e-02f, 2.94134259e-01f, -3.88895154e-01f, 3.00320745e-01f, 2.81504214e-01f, -1.43316567e-01f, 4.06507641e-01f, 3.36302906e-01f, 4.63832229e-01f, 2.62186617e-01f, -3.70109826e-02f, 3.44664276e-01f, 8.33335146e-02f, -3.01709563e-01f, 3.55725847e-02f, 1.82374157e-02f },
    { 3.89276117e-01f, 9.61025730e-02f, -1.05586983e-01f, 2.64987350e-01f, -2.18979478e-01f, 1.25016063e-01f, 2.53979713e-01f, 2.13606149e-01f, -1.89914092e-01f, -2.87751585e-01f, 3.77362341e-01f, -2.38494679e-01f, -2.47610975e-02f, 1.56872839e-01f, -5.95358200e-02f, -2.28878006e-01f },
    { -5.51812351e-01f, -3.01696002e-01f, 1.04846219e-02f, 2.44852394e-01f, -1.28868207e-01f, -1.67477876e-01f, 3.53708118e-01f, 3.80273640e-01f, 4.26199101e-03f, -6.68614218e-03f, -2.29083970e-01f, -2.15691067e-02f, 1.26620054e-01f, -5.18940091e-01f, -3.09656888e-01f, 2.31904358e-01f },
    { -9.99137312e-02f, -2.49635372e-02f, 1.36991322e-01f, -1.81668967e-01f, 2.37010106e-01f, 8.28249529e-02f, 9.83869582e-02f, 2.22913086e-01f, 3.76907676e-01f, -3.11924871e-02f, -1.95358768e-01f, 4.34532046e-01f, -2.57644027e-01f, 2.77659409e-02f, 2.28222340e-01f, 1.71281636e-01f },
    { -6.91912174e-02f, -4.57420833e-02f, -1.41114951e-03f, -2.08497614e-01f, -2.53067166e-01f, 8.00153315e-02f, -2.91220069e-01f, 1.36185154e-01f, 2.46230021e-01f, -2.44416464e-02f, 3.31064403e-01f, -3.36291604e-02f, 2.06099361e-01f, 4.36564386e-01f, -3.49088609e-01f, -1.59937143e-02f },
    { -4.34061140e-01f, -4.70826685e-01f, 1.60660163e-01f, -1.72897503e-01f, 1.77830696e-01f, 1.63992643e-01f, -2.45208204e-01f, 2.39237636e-01f, 2.31205851e-01f, -4.99283731e-01f, -4.03128833e-01f, 8.30299333e-02f, -9.30899680e-02f, -4.36029673e-01f, 2.29195021e-02f, 1.70142055e-01f },
    { -4.19555992e-01f, -3.13561916e-01f, -3.38246316e-01f, 4.46314109e-04f, 1.44407302e-01f, 2.50243336e-01f, 4.03160274e-01f, -1.67769253e-01f, 9.14158747e-02f, -4.95611280e-01f, 5.15426844e-02f, 3.67476761e-01f, -3.12989622e-01f, 2.43087970e-02f, -3.08832228e-01f, 4.10251290e-01f },
    { -4.28144902e-01f, -5.89910090e-01f, -4.41236556e-01f, 2.58054107e-01f, 1.84349746e-01f, 2.05545157e-01f, 1.76780626e-01f, -1.28676267e-02f, -2.20873907e-01f, -1.12223968e-01f, -6.89304292e-01f, -4.53870259e-02f, -5.42662680e-01f, -1.04030721e-01f, 1.87162861e-01f, 1.61879510e-01f },
    { 4.56994511e-02f, 2.15059757e-01f, -4.56252128e-01f, 2.22994134e-01f, -2.22327113e-01f, 2.68233031e-01f, 2.34737754e-01f, 3.12454104e-01f, -5.66942059e-02f, -7.79407695e-02f, 1.97639585e-01f, 6.30900487e-02f, 1.84345394e-01f, -1.96393698e-01f, -3.64029169e-01f, 1.60174906e-01f },
    { -4.38214391e-01f, -2.39816725e-01f, -3.62669438e-01f, -1.42346740e-01f, 3.14121068e-01f, -9.47278515e-02f, 3.47857207e-01f, 1.52602851e-01f, 4.56955805e-02f, 3.58214006e-02f, -1.39531836e-01f, 1.16285838e-01f, -3.06866586e-01f, -4.77309734e-01f, -1.45821393e-01f, 1.63683772e-01f },
    { -4.77073789e-01f, -2.32278243e-01f, -3.73396993e-01f, 4.24919993e-01f, -9.24169123e-02f, 3.65389198e-01f, 4.54738796e-01f, -9.52928513e-02f, 4.10408258e-01f, 2.51553953e-02f, -3.76897722e-01f, -1.09149273e-02f, -4.63386625e-01f, -3.00176531e-01f, 5.53130731e-02f, 8.03470463e-02f },
    { -4.26803052e-01f, -3.30306172e-01f, -2.98653424e-01f, 8.29595774e-02f, 2.56451815e-01f, -1.75680682e-01f, -2.24302962e-01f, 3.41346920e-01f, 1.20220333e-01f, 4.25714813e-02f, -3.40589404e-01f, -2.08535299e-01f, -5.28653204e-01f, -4.27446887e-02f, -3.13564569e-01f, -4.47159447e-02f },
    { -4.67604011e-01f, -2.24731371e-01f, -7.38909468e-02f, -2.16898888e-01f, 8.44314396e-02f, -1.64402410e-01f, 6.16372049e-01f, 4.61654246e-01f, 3.57808113e-01f, 1.85672164e-01f, -1.69418797e-01f, -2.32643500e-01f, -4.56173927e-01f, 1.77182987e-01f, -2.85317779e-01f, 4.29234594e-01f },
    { 4.56417874e-02f, 1.84823036e-01f, -2.74325371e-01f, -9.12276432e-02f, -1.37541499e-02f, 2.85751522e-01f, 4.97550607e-01f, 9.54150483e-02f, 1.68417379e-01f, 1.28767595e-01f, -2.71649301e-01f, 1.92567725e-02f, -1.44270554e-01f, -1.44662321e-01f, -2.96976864e-01f, 4.39429224e-01f },
    { 6.09470189e-01f, 3.08612078e-01f, 4.55762208e-01f, -1.84895515e-01f, 3.64728272e-01f, 1.58048272e-01f, -1.53189868e-01f, -9.60470811e-02f, 1.93630442e-01f, 4.82466519e-01f, -4.41448875e-02f, 3.53243381e-01f, 3.00382286e-01f, 5.69004118e-01f, -2.77234137e-01f, -2.32021406e-01f },
    { -8.77654627e-02f, 4.60415855e-02f, -1.21948428e-01f, -2.47507133e-02f, 4.41833496e-01f, 3.22809756e-01f, 6.07145607e-01f, -1.52639806e-01f, -1.29145846e-01f, -3.90364259e-01f, 4.60612541e-03f, 4.30606812e-01f, -2.78060257e-01f, 1.57316476e-01f, -1.36669323e-01f, 4.14045721e-01f },
    { 5.22334352e-02f, 1.46753453e-02f, 1.27620921e-01f, 1.83371678e-01f, 5.10037653e-02f, 1.13234565e-01f, 1.86977297e-01f, 1.09868288e-01f, -1.32302716e-01f, 2.36362368e-01f, -2.62982517e-01f, 3.04172095e-02f, 2.56048560e-01f, -2.19686016e-01f, -9.60568488e-02f, 4.79407281e-01f },
    { -3.55939925e-01f, 4.02050354e-02f, 7.14855716e-02f, 3.64721745e-01f, -3.36522371e-01f, -1.05201527e-01f, -8.54774266e-02f, 1.12265505e-01f, -1.96917444e-01f, 1.01483516e-01f, -2.09530160e-01f, -3.20305347e-01f, -2.89156884e-01f, -3.97265822e-01f, -2.48165116e-01f, -1.19327143e-01f },
    { -2.56767571e-01f, -1.82102308e-01f, -3.76414478e-01f, 3.45957011e-01f, 4.55379188e-01f, -1.67723879e-01f, 1.46021649e-01f, -1.95744988e-02f, -6.17068149e-02f, -1.58384144e-01f, -1.63255602e-01f, -2.36713231e-01f, -5.00729859e-01f, -1.17574930e-01f, 1.25653654e-01f, 5.10122955e-01f },
    { 4.72840369e-01f, 4.33521539e-01f, 1.26817673e-01f, -9.07904655e-02f, -2.40105484e-02f, -9.62672681e-02f, -3.85955215e-01f, -1.73238575e-01f, 7.23357350e-02f, 1.79346114e-01f, 2.45481595e-01f, -2.74512142e-01f, 3.77510756e-01f, 2.09675536e-01f, -1.98851585e-01f, -1.77063093e-01f },
    { 1.06615415e-02f, -2.19848603e-01f, -2.77275801e-01f, 3.94061357e-01f, -2.83116341e-01f, 1.50527447e-01f, -2.33403206e-01f, 1.66065216e-01f, 1.22172132e-01f, 1.67105675e-01f, 1.06147639e-01f, -1.66920170e-01f, -2.27371290e-01f, -3.39180917e-01f, 1.61583066e-01f, -1.82681233e-01f },
    { -1.40851930e-01f, -3.32996815e-01f, -1.75812572e-01f, -2.72144884e-01f, -3.32529396e-02f, -1.00444175e-01f, 3.49916160e-01f, 4.14972216e-01f, 3.50338668e-01f, -1.63648829e-01f, 2.98368223e-02f, -8.58170539e-02f, 2.40524650e-01f, -1.81798842e-02f, -3.12617332e-01f, -7.74970353e-02f },
    { 3.57933007e-02f, 3.09920549e-01f, 2.77631074e-01f, 2.63321221e-01f, -1.10962100e-01f, -1.84507355e-01f, 3.76139015e-01f, 2.04008326e-01f, -3.92578930e-01f, -1.17522500e-01f, 3.90254289e-01f, -1.47329107e-01f, 3.18590581e-01f, 3.59907538e-01f, 8.80103093e-03f, 2.86279678e-01f },
};

static const float b1[16] = {
3.42257798e-01f, 2.69582957e-01f, 1.79938614e-01f, -2.66147815e-02f, 1.29218847e-01f, 1.31564543e-01f, -1.87522128e-01f, -1.02969721e-01f, -1.82832316e-01f, 2.12695733e-01f, 2.77775615e-01f, 3.77625339e-02f, 2.29925275e-01f, 2.95935959e-01f, -4.32965718e-02f, -1.25951068e-02f};

// Layer 2
static const float W2[16][1] = {
    { 5.40176213e-01f },
    { 9.74384129e-01f },
    { 4.83672976e-01f },
    { -4.63897407e-01f },
    { -7.55652785e-01f },
    { -4.30585086e-01f },
    { -1.72453150e-01f },
    { -3.85892570e-01f },
    { -2.24230692e-01f },
    { 4.14563119e-01f },
    { 7.44162321e-01f },
    { -5.94112575e-01f },
    { 7.54269242e-01f },
    { 5.50033748e-01f },
    { 3.43049258e-01f },
    { -3.70593607e-01f },
};

static const float b2[1] = {
1.23700269e-01f};

NeuralNetwork neuralNet;

NeuralNetwork::NeuralNetwork() {}

float NeuralNetwork::relu(float x) const {
    return (x > 0.0f) ? x : 0.0f;
}

float NeuralNetwork::sigmoid(float x) const {
    return 1.0f / (1.0f + expf(-x));
}

void NeuralNetwork::dense(const float *input, int in_size,
                          const float *W, const float *b,
                          int out_size, float *output) const
{
    for (int o = 0; o < out_size; o++) {
        float sum = b[o];
        for (int i = 0; i < in_size; i++) {
            sum += input[i] * W[i * out_size + o];
        }
        output[o] = sum;
    }
}

float NeuralNetwork::predict(const float input[11])
{
    float h1[32];
    float h2[16];
    float out[1];

    dense(input, 11, (float*)W0, b0, 32, h1);
    for (int i = 0; i < 32; i++) h1[i] = relu(h1[i]);

    dense(h1, 32, (float*)W1, b1, 16, h2);
    for (int i = 0; i < 16; i++) h2[i] = relu(h2[i]);

    dense(h2, 16, (float*)W2, b2, 1, out);
    return sigmoid(out[0]);
}
